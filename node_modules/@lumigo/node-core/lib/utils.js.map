{"version":3,"file":"utils.js","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":";;;AAAA,qCAAqC;AAErC,MAAM,UAAU,GAAG,cAAc,CAAC;AAClC,MAAM,eAAe,GAAG,mBAAmB,CAAC;AAC5C,MAAM,SAAS,GAAG,gBAAgB,CAAC;AACtB,QAAA,yCAAyC,GAAG,wBAAwB,CAAC;AACrE,QAAA,2BAA2B,GAAG,6BAA6B,CAAC;AAC5D,QAAA,+CAA+C,GAC1D,iDAAiD,CAAC;AACvC,QAAA,gDAAgD,GAC3D,kDAAkD,CAAC;AACxC,QAAA,gDAAgD,GAC3D,kDAAkD,CAAC;AACxC,QAAA,iDAAiD,GAC5D,mDAAmD,CAAC;AACzC,QAAA,6CAA6C,GACxD,+CAA+C,CAAC;AACrC,QAAA,uCAAuC,GAAG,yCAAyC,CAAC;AACpF,QAAA,+BAA+B,GAAG,KAAK,CAAC;AAExC,QAAA,6BAA6B,GAAG,+BAA+B,CAAC;AAChE,QAAA,qBAAqB,GAAG;IACnC,UAAU;IACV,SAAS;IACT,YAAY;IACZ,gBAAgB;IAChB,gBAAgB;IAChB,WAAW;IACX,cAAc;IACd,sBAAsB;IACtB,WAAW;IACX,YAAY;IACZ,eAAe;CAChB,CAAC;AAEF,SAAgB,QAAQ,CAAC,CAAM;IAC7B,OAAO,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,iBAAiB,CAAC;AACjE,CAAC;AAFD,4BAEC;AAEM,MAAM,WAAW,GAAG,GAAY,EAAE,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;AAA7D,QAAA,WAAW,eAAkD;AAE1E,MAAM,cAAc,GAAG,CAAC,MAAc,EAAE,KAAK,GAAG,MAAM,EAAW,EAAE,CACjE,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,KAAK,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;AAEhF,MAAM,cAAc,GAAG,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,GAAG,MAAM,CAAC,CAAC;AAA/D,QAAA,cAAc,kBAAiD;AAErE,MAAM,OAAO,GAAG,GAAY,EAAE,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;AAApD,QAAA,OAAO,WAA6C;AAE1D,MAAM,QAAQ,GAAG,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,GAAG,MAAM,CAAC,CAAC;AAAxD,QAAA,QAAQ,YAAgD;AAE9D,MAAM,OAAO,GAAG,GAAG,EAAE,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,CAAC;AAAlD,QAAA,OAAO,WAA2C;AAExD,MAAM,MAAM,GAAG,GAAY,EAAE,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;AAAlD,QAAA,MAAM,UAA4C;AAElD,QAAA,qBAAqB,GAAG,IAAI,CAAC;AAEnC,MAAM,kBAAkB,GAAG,CAAC,QAAQ,GAAG,KAAK,EAAE,EAAE;IACrD,MAAM,SAAS,GACb,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;QAC9C,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;QAC9C,6BAAqB,CAAC;IACxB,IAAI,QAAQ,EAAE;QACZ,OAAO,SAAS,GAAG,CAAC,CAAC;KACtB;IACD,OAAO,SAAS,CAAC;AACnB,CAAC,CAAC;AATW,QAAA,kBAAkB,sBAS7B;AAEK,MAAM,mBAAmB,GAAG,CAAC,MAAM,EAAE,UAAU,GAAG,KAAK,EAAE,kBAAwB,EAAO,EAAE;IAC/F,IAAI;QACF,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;KACxC;IAAC,OAAO,CAAC,EAAE;QACV,UAAU,IAAI,IAAA,kBAAS,GAAE,CAAC,UAAU,CAAC,GAAG,MAAM,0BAA0B,CAAC,CAAC;KAC3E;IACD,OAAO,kBAAkB,CAAC;AAC5B,CAAC,CAAC;AAPW,QAAA,mBAAmB,uBAO9B;AAEF,SAAgB,WAAW,CACzB,QAAkB,EAClB,OAAO,GAAG,wBAAwB,EAClC,QAAQ,GAAG,IAAA,kBAAS,GAAE,CAAC,UAAU,CAAC,OAAO,EACzC,gBAAmB,SAAS;IAE5B,OAAO,UAAU,GAAG,IAAI;QACtB,IAAI;YACF,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SACnC;QAAC,OAAO,GAAG,EAAE;YACZ,IAAA,kBAAS,GAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;YACxC,OAAO,aAAa,CAAC;SACtB;IACH,CAAC,CAAC;AACJ,CAAC;AAdD,kCAcC","sourcesContent":["import { getLogger } from './logger';\n\nconst DEBUG_FLAG = 'LUMIGO_DEBUG';\nconst STORE_LOGS_FLAG = 'LUMIGO_STORE_LOGS';\nconst WARM_FLAG = 'LUMIGO_IS_WARM';\nexport const LUMIGO_SECRET_MASKING_REGEX_BACKWARD_COMP = 'LUMIGO_BLACKLIST_REGEX';\nexport const LUMIGO_SECRET_MASKING_REGEX = 'LUMIGO_SECRET_MASKING_REGEX';\nexport const LUMIGO_SECRET_MASKING_REGEX_HTTP_REQUEST_BODIES =\n  'LUMIGO_SECRET_MASKING_REGEX_HTTP_REQUEST_BODIES';\nexport const LUMIGO_SECRET_MASKING_REGEX_HTTP_REQUEST_HEADERS =\n  'LUMIGO_SECRET_MASKING_REGEX_HTTP_REQUEST_HEADERS';\nexport const LUMIGO_SECRET_MASKING_REGEX_HTTP_RESPONSE_BODIES =\n  'LUMIGO_SECRET_MASKING_REGEX_HTTP_RESPONSE_BODIES';\nexport const LUMIGO_SECRET_MASKING_REGEX_HTTP_RESPONSE_HEADERS =\n  'LUMIGO_SECRET_MASKING_REGEX_HTTP_RESPONSE_HEADERS';\nexport const LUMIGO_SECRET_MASKING_REGEX_HTTP_QUERY_PARAMS =\n  'LUMIGO_SECRET_MASKING_REGEX_HTTP_QUERY_PARAMS';\nexport const LUMIGO_SECRET_MASKING_REGEX_ENVIRONMENT = 'LUMIGO_SECRET_MASKING_REGEX_ENVIRONMENT';\nexport const LUMIGO_SECRET_MASKING_ALL_MAGIC = 'all';\n\nexport const LUMIGO_WHITELIST_KEYS_REGEXES = 'LUMIGO_WHITELIST_KEYS_REGEXES';\nexport const OMITTING_KEYS_REGEXES = [\n  '.*pass.*',\n  '.*key.*',\n  '.*secret.*',\n  '.*credential.*',\n  '.*passphrase.*',\n  '.*token.*',\n  'SessionToken',\n  'x-amz-security-token',\n  'Signature',\n  'Credential',\n  'Authorization',\n];\n\nexport function isString(x: any): x is string {\n  return Object.prototype.toString.call(x) === '[object String]';\n}\n\nexport const isStoreLogs = (): boolean => validateEnvVar(STORE_LOGS_FLAG);\n\nconst validateEnvVar = (envVar: string, value = 'TRUE'): boolean =>\n  !!(process.env[envVar] && process.env[envVar].toUpperCase() === value.toUpperCase());\n\nexport const setStoreLogsOn = () => (process.env[STORE_LOGS_FLAG] = 'TRUE');\n\nexport const isDebug = (): boolean => validateEnvVar(DEBUG_FLAG);\n\nexport const setDebug = () => (process.env['LUMIGO_DEBUG'] = 'TRUE');\n\nexport const setWarm = () => (process.env[WARM_FLAG] = 'TRUE');\n\nexport const isWarm = (): boolean => validateEnvVar(WARM_FLAG);\n\nexport const LUMIGO_MAX_ENTRY_SIZE = 2048;\n\nexport const getEventEntitySize = (hasError = false) => {\n  const basicSize =\n    parseInt(process.env['MAX_EVENT_ENTITY_SIZE']) ||\n    parseInt(process.env['LUMIGO_MAX_ENTRY_SIZE']) ||\n    LUMIGO_MAX_ENTRY_SIZE;\n  if (hasError) {\n    return basicSize * 2;\n  }\n  return basicSize;\n};\n\nexport const parseJsonFromEnvVar = (envVar, warnClient = false, defaultReturnValue?: any): any => {\n  try {\n    return JSON.parse(process.env[envVar]);\n  } catch (e) {\n    warnClient && getLogger().warnClient(`${envVar} need to be a valid JSON`);\n  }\n  return defaultReturnValue;\n};\n\nexport function safeExecute<T>(\n  callback: Function,\n  message = 'Error in Lumigo tracer',\n  logLevel = getLogger().LOG_LEVELS.WARNING,\n  defaultReturn: T = undefined\n): Function {\n  return function (...args) {\n    try {\n      return callback.apply(this, args);\n    } catch (err) {\n      getLogger().log(logLevel, message, err);\n      return defaultReturn;\n    }\n  };\n}\n"]}