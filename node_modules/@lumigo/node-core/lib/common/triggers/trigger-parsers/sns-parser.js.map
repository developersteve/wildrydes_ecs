{"version":3,"file":"sns-parser.js","sourceRoot":"","sources":["../../../../src/common/triggers/trigger-parsers/sns-parser.ts"],"names":[],"mappings":";;;AACA,+DAA6D;AAC7D,kEAAyD;AACzD,qDAAiD;AAEjD,MAAa,gBAAiB,SAAQ,0CAAoB;IAA1D;;QACE,qBAAgB,GAAG,2BAA2B,CAAC;QAE/C,kBAAa,GAAG,CAAC,OAAwB,EAAW,EAAE;;YACpD,OAAO,CACL,CAAA,MAAA,MAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,0CAAG,CAAC,CAAC,0CAAE,WAAW,MAAK,SAAS;gBAChD,CAAC,CAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI,MAAK,cAAc,KAAI,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,QAAQ,CAAA,CAAC,CACxD,CAAC;QACJ,CAAC,CAAC;QAEF,WAAM,GAAG,CAAC,OAAwB,EAAE,QAAuB,EAAW,EAAE;;YACtE,MAAM,MAAM,GAAG,CAAA,MAAA,MAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,0CAAG,CAAC,CAAC,0CAAE,GAAG,KAAI,OAAO,CAAC;YACrD,OAAO;gBACL,EAAE,EAAE,IAAA,0BAAW,GAAE;gBACjB,QAAQ,EAAE,QAAQ;gBAClB,WAAW,EAAE,qCAAc,CAAC,GAAG;gBAC/B,cAAc,EAAE,CAAC,MAAM,CAAC,SAAS,CAAC;gBAClC,KAAK,EAAE;oBACL,GAAG,EAAE,MAAM,CAAC,QAAQ;iBACrB;aACF,CAAC;QACJ,CAAC,CAAC;IACJ,CAAC;CAAA;AAtBD,4CAsBC","sourcesContent":["import { IncomingMessage, Trigger } from '../trigger-data.types';\nimport { MessageTriggerParser } from './trigger-parser-base';\nimport { MessageTrigger } from '../message-trigger.enum';\nimport { getRandomId } from '../../generalUtils';\n\nexport class SnsMessageParser extends MessageTriggerParser {\n  INNER_IDENTIFIER = 'SimpleNotificationService';\n\n  _shouldHandle = (message: IncomingMessage): boolean => {\n    return (\n      message?.Records?.[0]?.EventSource === 'aws:sns' ||\n      (message?.Type === 'Notification' && message?.TopicArn)\n    );\n  };\n\n  handle = (message: IncomingMessage, targetId: string | null): Trigger => {\n    const record = message?.Records?.[0]?.Sns || message;\n    return {\n      id: getRandomId(),\n      targetId: targetId,\n      triggeredBy: MessageTrigger.SNS,\n      fromMessageIds: [record.MessageId],\n      extra: {\n        arn: record.TopicArn,\n      },\n    };\n  };\n}\n"]}