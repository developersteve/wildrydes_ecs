{"version":3,"file":"s3-parser.js","sourceRoot":"","sources":["../../../../src/common/triggers/trigger-parsers/s3-parser.ts"],"names":[],"mappings":";;;AACA,+DAA6D;AAC7D,qDAAiD;AACjD,kEAAyD;AAEzD,MAAa,eAAgB,SAAQ,0CAAoB;IAAzD;;QACE,kBAAa,GAAG,CAAC,OAAwB,EAAW,EAAE;;YACpD,OAAO,CAAA,MAAA,MAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,0CAAG,CAAC,CAAC,0CAAE,WAAW,MAAK,QAAQ,CAAC;QACzD,CAAC,CAAC;QAEF,WAAM,GAAG,CAAC,OAAwB,EAAE,QAAuB,EAAW,EAAE;;YACtE,OAAO;gBACL,EAAE,EAAE,IAAA,0BAAW,GAAE;gBACjB,QAAQ,EAAE,QAAQ;gBAClB,WAAW,EAAE,qCAAc,CAAC,EAAE;gBAC9B,cAAc,EAAE,CAAC,MAAA,MAAA,MAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,0CAAG,CAAC,CAAC,0CAAE,gBAAgB,0CAAG,kBAAkB,CAAC,CAAC;gBAC/E,KAAK,EAAE;oBACL,GAAG,EAAE,MAAA,MAAA,MAAA,MAAA,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,0CAAG,CAAC,CAAC,0CAAE,EAAE,0CAAE,MAAM,0CAAE,GAAG;iBAC5C;aACF,CAAC;QACJ,CAAC,CAAC;IACJ,CAAC;CAAA;AAhBD,0CAgBC","sourcesContent":["import { IncomingMessage, Trigger } from '../trigger-data.types';\nimport { MessageTriggerParser } from './trigger-parser-base';\nimport { getRandomId } from '../../generalUtils';\nimport { MessageTrigger } from '../message-trigger.enum';\n\nexport class S3MessageParser extends MessageTriggerParser {\n  _shouldHandle = (message: IncomingMessage): boolean => {\n    return message?.Records?.[0]?.eventSource === 'aws:s3';\n  };\n\n  handle = (message: IncomingMessage, targetId: string | null): Trigger => {\n    return {\n      id: getRandomId(),\n      targetId: targetId,\n      triggeredBy: MessageTrigger.S3,\n      fromMessageIds: [message?.Records?.[0]?.responseElements?.['x-amz-request-id']],\n      extra: {\n        arn: message?.Records?.[0]?.s3?.bucket?.arn,\n      },\n    };\n  };\n}\n"]}