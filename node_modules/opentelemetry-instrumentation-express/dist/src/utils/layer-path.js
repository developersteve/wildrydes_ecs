"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLayerPathFromFirstArg = void 0;
const path_to_regexp_1 = __importDefault(require("path-to-regexp"));
const pathStringToDisplayValue = (pathInput, options) => {
    if (!options.strict && pathInput !== '/' && pathInput.endsWith('/')) {
        return pathInput.substr(0, pathInput.length - 1);
    }
    return pathInput;
};
// get the first argument in calls like router.use('/path', ...),
// handle the various types, and transform regexp to string
const getLayerPathAlternativeFromFirstArg = (pathInput, options) => {
    if (typeof pathInput === 'string') {
        return {
            userSuppliedValue: pathInput,
            displayValue: pathStringToDisplayValue(pathInput, options),
            regexp: path_to_regexp_1.default(pathInput, [], options),
        };
    }
    if (pathInput instanceof RegExp)
        return {
            userSuppliedValue: pathInput,
            displayValue: pathInput.toString(),
            regexp: path_to_regexp_1.default(pathInput, [], options),
        };
    if (Array.isArray(pathInput)) {
        return pathInput.map((alternativePath) => ({
            userSuppliedValue: alternativePath,
            displayValue: typeof alternativePath === 'string'
                ? pathStringToDisplayValue(alternativePath, options)
                : alternativePath instanceof RegExp
                    ? alternativePath.toString()
                    : undefined,
            regexp: path_to_regexp_1.default(alternativePath, [], options),
        }));
    }
    return undefined;
};
const getLayerPathFromFirstArg = (path, options) => {
    const alternatives = getLayerPathAlternativeFromFirstArg(path, options);
    if (!alternatives)
        return undefined;
    return {
        fastSlash: path === '/',
        alternatives,
        displayValue: Array.isArray(alternatives)
            ? JSON.stringify(alternatives.map((a) => a.displayValue))
            : alternatives.displayValue,
    };
};
exports.getLayerPathFromFirstArg = getLayerPathFromFirstArg;
//# sourceMappingURL=layer-path.js.map